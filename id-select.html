<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="id-form-styles.html">
<link rel="import" href="./id-form-element-mixin.html">
<link rel="import" href="../id-button/id-button.html">
<!--
`id-select` Select form field with Idaho styling.

@demo demo/index.html
-->

<dom-module id="id-select">
  <template>
    <style include="id-form-styles">

      @media (min-width: 768px) {
        :host(.lg) select {
          width: 80%;
        }

        :host(.md) select {
          width: 50%;
        }

        :host(.sm) select {
          width: 25%;
        }

        :host(.xs) select {
          width: 15%;
        }
      }

      select {
        display: block;
        width: 100%;
        height: calc(2.25rem + 2px);
        padding: .375rem 1.75rem .375rem .75rem;
        line-height: 1.25;
        vertical-align: middle;
        color: #464a4c;
        background: #fff url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23333' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E") no-repeat right 0.75rem center;
         -webkit-background-size: 8px 10px;
                 background-size: 8px 10px;
        border: 1px solid rgba(0,0,0,.15);
        border-radius: .25rem;
        -moz-appearance: none;
        -webkit-appearance: none;
        -ms-touch-action: manipulation;
        touch-action: manipulation;
      }

      select:focus {
        color: #464a4c;
        background-color: #fff;
        border-color: #5cb3fd;
        outline: 0;
      }

      :host([repeat-button]) select {
        float: left;
        margin-right: 1rem;
      }

    </style>
    <template is="dom-if" if="[[label]]">
      <label id="fieldLabel">[[label]]</label>
    </template>
    <div id="fieldControl">
      <select name$="[[name]]" on-change="_select">
        <template is="dom-repeat" items="{{choices}}">
            <option value$="[[item]]" selected="{{_selected(item, bindValue)}}">[[item]]</option>
        </template>
      </select>
    </div>
  </template>

  <script>
    class IdSelect extends IdFormElementMixin(Polymer.Element) {
      static get is() { return 'id-select'; }
      static get properties() {
        return {
          /**
           * List of possible values for the radios.
          **/
          choices: Array
        };
      }

      /**
       * Determines if the radio is selected.
       * @param  {string} item      Value of item to check.
       * @param  {string} bindValue Value of bindValue variable.
       * @return boolean            Is selected.
       */
      _selected(item, bindValue) {
        return (item === bindValue);
      }

      /**
       * On change event for when a radio is selected
       * @param  {object} e      Event detail
       * @param  {detail} detail Detail for event
       * @param  {object} sender Node that sent the event
       * @return null
       */
      _select(e, detail, sender) {
        this.select(e.target.value);
      }

      /**
       * Set the current selected value.
       * @param  {string} value Value to set
       * @return null
       */
      select(value) {
        this.set('bindValue', value);
      }

      ready() {
        super.ready();
        if (!this.bindValue) {
          this.bindValue = this.choices[0];
        }
      }
    }

    window.customElements.define(IdSelect.is, IdSelect);
  </script>
</dom-module>
